@using TonerTracker.Domain.Dto
@using TonerTracker.Domain.Entity;
@using TonerTracker.Utilities.Constant
@model DeliveryNCountDto

@{
   ViewBag.Title = "Toner Delivery and Paper Count";
}

<!-- Branch content -->
<div class="container-fluid pt-4 px-4">
   <div class="theme-bg-secondary theme-font-color text-center rounded p-4">

      <!-- Title -->
      <div class="d-flex align-items-center justify-content-between mb-4">
         <h1 class="mb-0 display-6">@ViewBag.Title</h1>
         <a class="theme-anchor" asp-controller="DeliveryNCount" asp-action="Create" asp-route-machineId="@Model.TonerDeliveries.ToList().First().MachineID">Add New Machine</a>
      </div>

      <!--ALERT-->
      @if (Convert.ToString(TempData[SessionConstant.Message]).Length > 1)
      {
         <div class="alert alert-success alert-dismissible text-center fade show" id="alert" role="alert">
            <i class="bi bi-check-circle-fill"></i>&nbsp; @TempData[SessionConstant.Message]
            <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
         </div>
      }
      <div class="table-responsive">
         @if (Model.TonerErrorMessage != null)
         {
            <h2 class="text-center display-6 text-danger">@Model.TonerErrorMessage</h2>
         }
         else
         {
            <h2 class="text-center display-6">Toner Deliveries</h2>
         }

         @if (Model.TonerDeliveries.ToList().First().Machine.ColourType == ColourType.BW)
         {
            <table class="table text-start align-middle table-bordered table-hover mb-2">
               <thead>
                  <tr class="text-white theme-font-color">
                     <th scope="col">Machine</th>
                     <th scope="col">DeliveryBW</th>
                     <th scope="col">StockBW</th>
                     <th scope="col">Action</th>
                  </tr>
               </thead>
               <tbody class="theme-font-color">
                  @foreach (var item in Model.TonerDeliveries)
                  {
                     <tr>
                        <td>@item.Machine.MachineModelNo</td>
                        <td>@item.DeliveryBW</td>
                        <td>
                           <a class="detail-link" asp-action="Detail" asp-route-Id="@item.ID">@item.StockBW</a>
                        </td>
                        <td>
                           <a asp-action="Update" asp-route-id="@item.ID" class="btn btn-sm btn-primary mt-1 mb-1">
                              <i class="fas fa-pen"></i>
                              Update
                           </a>
                           <a asp-action="Detail" asp-route-id="@item.ID" class="btn btn-sm btn-success mt-1 mb-1">
                              <i class="fas fa-info-circle"></i>
                              Detail
                           </a>
                           <a asp-action="Delete" asp-route-id="@item.ID" class="btn btn-sm btn-danger mt-1 mb-1">
                              <i class="fas fa-trash"></i>
                              Delete
                           </a>
                           @*<a asp-controller="TonerDelivery" asp-action="Create" asp-route-machineId="@item.ID" class="btn btn-sm btn-info mt-1 mb-1">
                     <i class="fas fa-list-ul"></i>
                     Toner Delivery
                     </a>*@
                        </td>
                     </tr>
                  }
               </tbody>
            </table>
         }
         else
         {
            <table class="table text-start align-middle table-bordered table-hover mb-2">
               <thead>
                  <tr class="text-white theme-font-color">
                     <th scope="col">Machine</th>
                     <th scope="col">Delivery Cyan</th>
                     <th scope="col">Delivery Magenta</th>
                     <th scope="col">Delivery Yellow</th>
                     <th scope="col">Delivery Black</th>
                     <th scope="col">Stock Cyan</th>
                     <th scope="col">Stock Magenta</th>
                     <th scope="col">Stock Yellow</th>
                     <th scope="col">Stock Black</th>
                     <th scope="col">Action</th>
                  </tr>
               </thead>
               <tbody class="theme-font-color">
                  @foreach (var item in Model.TonerDeliveries)
                  {
                     <tr>
                        <td>@item.Machine.MachineSerialNo</td>
                        <td>@item.DeliveryCyan</td>
                        <td>@item.DeliveryMagenta</td>
                        <td>@item.DeliveryYellow</td>
                        <td>@item.DeliveryBlack</td>
                        <td><a class="detail-link" asp-action="Detail" asp-route-Id="@item.ID">@item.StockCyan</a></td>
                        <td><a class="detail-link" asp-action="Detail" asp-route-Id="@item.ID">@item.StockMagenta</a></td>
                        <td><a class="detail-link" asp-action="Detail" asp-route-Id="@item.ID">@item.StockYellow</a></td>
                        <td><a class="detail-link" asp-action="Detail" asp-route-Id="@item.ID">@item.StockBlack</a></td>
                        <td>
                           <a asp-action="Update" asp-route-Id="@item.ID" class="btn btn-sm btn-primary mt-1 mb-1">
                              <i class="fas fa-pen"></i>
                              @* Update*@
                           </a>
                           <a asp-action="Detail" asp-route-Id="@item.ID" class="btn btn-sm btn-success mt-1 mb-1">
                              <i class="fas fa-info-circle"></i>
                              @*Detail*@
                           </a>
                           <a asp-action="Delete" asp-route-Id="@item.ID" class="btn btn-sm btn-danger mt-1 mb-1">
                              <i class="fas fa-trash"></i>
                              @*Delete*@
                           </a>
                        </td>
                     </tr>
                  }
               </tbody>
            </table>
         }

         <div class="text-start">
            <a asp-controller="Machine" asp-action="Index" asp-route-branchId="@Model.TonerDeliveries.ToList().First().Machine.BranchID" class="btn btn-secondary mt-3 mb-1 text-start ">
               <i class="fas fa-long-arrow-alt-left"></i> &nbsp;Back To Branch List
            </a>
         </div>
      </div>
   </div>
</div>
<!-- Delivery content -->
@*<script type="text/javascript">
   window.setTimeout(function () {
      $('#alert').remove('fast');
   }, 2000);
</script>*@